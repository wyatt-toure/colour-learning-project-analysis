<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Model 3 - Preference for the rewarded object during testing depending on treatment | Analysis for ‘Biases in learned foraging preferences for coloured objects in Trinidadian guppies’</title>
  <meta name="description" content="Model 3 - Preference for the rewarded object during testing depending on treatment | Analysis for ‘Biases in learned foraging preferences for coloured objects in Trinidadian guppies’" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Model 3 - Preference for the rewarded object during testing depending on treatment | Analysis for ‘Biases in learned foraging preferences for coloured objects in Trinidadian guppies’" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Model 3 - Preference for the rewarded object during testing depending on treatment | Analysis for ‘Biases in learned foraging preferences for coloured objects in Trinidadian guppies’" />
  
  
  

<meta name="author" content="Wyatt Toure" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="model-2-preference-for-the-rewarding-object-during-training.html"/>
<link rel="next" href="esm-model-1-preference-for-the-rewarded-object-during-training-based-on-feeding.html"/>
<script src="libs/header-attrs-2.6.4/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Colour learning analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Background</a></li>
<li class="chapter" data-level="" data-path="model-1-preference-for-the-green-object-at-baseline.html"><a href="model-1-preference-for-the-green-object-at-baseline.html"><i class="fa fa-check"></i>Model 1 - Preference for the green object at baseline</a></li>
<li class="chapter" data-level="" data-path="model-2-preference-for-the-rewarding-object-during-training.html"><a href="model-2-preference-for-the-rewarding-object-during-training.html"><i class="fa fa-check"></i>Model 2 - Preference for the rewarding object during training</a></li>
<li class="chapter" data-level="" data-path="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html"><a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html"><i class="fa fa-check"></i>Model 3 - Preference for the rewarded object during testing depending on treatment</a>
<ul>
<li class="chapter" data-level="" data-path="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html"><a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html#main-effects"><i class="fa fa-check"></i>Main effects</a></li>
<li class="chapter" data-level="" data-path="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html"><a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html#post-hoc-comparisons"><i class="fa fa-check"></i>Post-hoc Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="esm-model-1-preference-for-the-rewarded-object-during-training-based-on-feeding.html"><a href="esm-model-1-preference-for-the-rewarded-object-during-training-based-on-feeding.html"><i class="fa fa-check"></i>ESM Model 1 - Preference for the rewarded object during training based on feeding</a></li>
<li class="chapter" data-level="" data-path="model-4-is-there-a-difference-in-feeding-attempts-between-treatments.html"><a href="model-4-is-there-a-difference-in-feeding-attempts-between-treatments.html"><i class="fa fa-check"></i>Model 4 - Is there a difference in feeding attempts between treatments?</a></li>
<li class="chapter" data-level="" data-path="esm-model-2-controlling-for-feeding-count.html"><a href="esm-model-2-controlling-for-feeding-count.html"><i class="fa fa-check"></i>ESM Model 2 - Controlling for feeding count</a>
<ul>
<li class="chapter" data-level="" data-path="esm-model-2-controlling-for-feeding-count.html"><a href="esm-model-2-controlling-for-feeding-count.html#esm-model-2a---removing-individual-that-did-not-feed"><i class="fa fa-check"></i>ESM Model 2a - Removing individual that did not feed</a></li>
<li class="chapter" data-level="" data-path="esm-model-2-controlling-for-feeding-count.html"><a href="esm-model-2-controlling-for-feeding-count.html#esm-model-2b---including-feeding-counut-as-a-covariate"><i class="fa fa-check"></i>ESM Model 2b - Including feeding counut as a covariate</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="tools-used-and-references.html"><a href="tools-used-and-references.html"><i class="fa fa-check"></i>Tools used and References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analysis for ‘Biases in learned foraging preferences for coloured objects in Trinidadian guppies’</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="model-3---preference-for-the-rewarded-object-during-testing-depending-on-treatment" class="section level1">
<h1>Model 3 - Preference for the rewarded object during testing depending on treatment</h1>
<div id="main-effects" class="section level2">
<h2>Main effects</h2>
<p>For the main effects of training and rewarding object colour on rewarding object preference I initially fit a linear mixed effects model with fixed effects of trial and rewarding object colour and a random effect of individual id.</p>
<p>Due to heterogeneity in the variance among groups however, I switched to a generalized linear mixed effects model with a Gaussian distribution which also modeled the variances to account for variance heterogeneity using the package <a href="https://cran.r-project.org/web/packages/glmmTMB/index.html"><code>glmmTMB</code></a>. My third model asks whether the preference for the rewarding object changed between baseline and final test and looks for an interaction with rewarded object colour.</p>
<p><strong>Variables</strong></p>
<ul>
<li><code>rewarding.object.preference</code> is the time (seconds) spent near the rewarding object subtracted by the time spent near the unrewarding object</li>
<li><code>rewarding.object.colour</code> is the identity of the rewarding object (blue or green)</li>
<li><code>trial</code> is the number of the training trial. In this model it is supplied as a factor where 0 is the baseline trial and 21 is the final trial</li>
<li><code>id</code> is the identity of the individual fish</li>
</ul>
<p><strong>Model</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html#cb3-1" aria-hidden="true" tabindex="-1"></a>test.data.model.glm <span class="ot">=</span> </span>
<span id="cb3-2"><a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">glmmTMB</span>(rewarding.object.preference <span class="sc">~</span>  trial <span class="sc">*</span> rewarding.object.colour <span class="sc">+</span> (<span class="dv">1</span><span class="sc">|</span>id) <span class="sc">+</span> </span>
<span id="cb3-3"><a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">diag</span>(<span class="dv">0</span> <span class="sc">+</span> rewarding.object.colour<span class="sc">:</span>trial <span class="sc">|</span>id), </span>
<span id="cb3-4"><a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> test.data, <span class="at">family =</span> gaussian)</span></code></pre></div>
<p><strong>Results</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left;">
term
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
std.error
</th>
<th style="text-align:right;">
statistic
</th>
<th style="text-align:right;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
trial21
</td>
<td style="text-align:right;">
17.697
</td>
<td style="text-align:right;">
10.017
</td>
<td style="text-align:right;">
1.767
</td>
<td style="text-align:right;">
0.077
</td>
</tr>
<tr>
<td style="text-align:left;">
rewarding.object.colourgreen
</td>
<td style="text-align:right;">
1.645
</td>
<td style="text-align:right;">
5.542
</td>
<td style="text-align:right;">
0.297
</td>
<td style="text-align:right;">
0.767
</td>
</tr>
<tr>
<td style="text-align:left;">
trial21:rewarding.object.colourgreen
</td>
<td style="text-align:right;">
65.351
</td>
<td style="text-align:right;">
20.832
</td>
<td style="text-align:right;">
3.137
</td>
<td style="text-align:right;">
0.002
</td>
</tr>
</tbody>
</table>
<p>I found a significant interaction effect between trial and rewarding object colour (p = 0.002). Guppies that had the green object rewarded had a final rewarded object preference that was 65.4 seconds stronger than the rewarded object preference of guppies trained to blue (Figure <a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html#fig:test-data-pref-plot">3</a>).</p>
<center>
<div class="figure"><span id="fig:test-data-pref-plot"></span>
<img src="Analysis-for-Bias-in-the-shift-of-foraging-preference-for-coloured-objects-in-Trinidadian-guppies_files/figure-html/test-data-pref-plot-1.png" alt="The initial and final rewarding object preference. Dashed line represents the no preference value. Data are means +/- 95% CI. Bold line connects means across trials." width="672" />
<p class="caption">
Figure 3: The initial and final rewarding object preference. Dashed line represents the no preference value. Data are means +/- 95% CI. Bold line connects means across trials.
</p>
</div>
</center>
<p></br></p>
<p><strong>Model Residuals</strong></p>
<p>Originally I fit a LMM but they variance among the groups was uneven producing the following residual plot.</p>
<p><img src="Analysis-for-Bias-in-the-shift-of-foraging-preference-for-coloured-objects-in-Trinidadian-guppies_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>I therefore used glmmTMB to allow for the modeling of the variances and account for heterogeneous variance.</p>
<p><img src="Analysis-for-Bias-in-the-shift-of-foraging-preference-for-coloured-objects-in-Trinidadian-guppies_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
</div>
<div id="post-hoc-comparisons" class="section level2">
<h2>Post-hoc Comparisons</h2>
<p>To determine whether the means of the final rewarding object preference for the two treatments were different I conducted post-hoc comparisons with the package <a href="https://cran.r-project.org/package=emmeans"><code>emmeans</code></a>. I compared the following means:</p>
<ul>
<li>Final test blue-trained and initial test blue-trained</li>
<li>Final test green-trained and initial test green-trained</li>
<li>Final test green-trained and final test blue-trained</li>
<li>Initial test green-trained and initial test blue-trained</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html#cb4-1" aria-hidden="true" tabindex="-1"></a>test.data.model.pairwise.comparisons <span class="ot">=</span> </span>
<span id="cb4-2"><a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(test.data.model2, <span class="at">specs =</span> <span class="sc">~</span> trial<span class="sc">:</span>rewarding.object.colour)</span>
<span id="cb4-3"><a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html#cb4-4" aria-hidden="true" tabindex="-1"></a>custom.contrasts <span class="ot">=</span> <span class="fu">contrast</span>(test.data.model.pairwise.comparisons, </span>
<span id="cb4-5"><a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html#cb4-5" aria-hidden="true" tabindex="-1"></a>                            <span class="at">method =</span> <span class="fu">list</span>(<span class="st">&quot;21 blue - 0 blue&quot;</span> <span class="ot">=</span> blue21<span class="sc">-</span> blue0,</span>
<span id="cb4-6"><a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html#cb4-6" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">&quot;21 green - 0 green &quot;</span> <span class="ot">=</span> green21 <span class="sc">-</span> green0,</span>
<span id="cb4-7"><a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html#cb4-7" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">&quot;21 green - 21 blue&quot;</span> <span class="ot">=</span> green21 <span class="sc">-</span> blue21,</span>
<span id="cb4-8"><a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html#cb4-8" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">&quot;0 green - 0 blue&quot;</span> <span class="ot">=</span> green0<span class="sc">-</span> blue0), </span>
<span id="cb4-9"><a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html#cb4-9" aria-hidden="true" tabindex="-1"></a>                            <span class="at">adjust =</span> <span class="st">&quot;mvt&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">summary</span>(<span class="at">infer =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><strong>Results</strong></p>
<table>
<caption>
<span id="tab:contrasts-table">Table 1: </span>Table of post-hoc tests with a multivariate-t adjustment for multiple comparisons of a selected set of means. The numbers represent the initial test trial (0) and the final test trial (21). The colour corressponds to the identity of the rewarding object (blue for blue-trained guppies, green for green-trained guppies). Values are all rounded to 3 decimal places. CL = confidence limit
</caption>
<thead>
<tr>
<th style="text-align:left;">
contrast
</th>
<th style="text-align:right;">
estimate
</th>
<th style="text-align:right;">
lower.CL
</th>
<th style="text-align:right;">
upper.CL
</th>
<th style="text-align:right;">
df
</th>
<th style="text-align:left;">
p.value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
21 blue - 0 blue
</td>
<td style="text-align:right;">
17.697
</td>
<td style="text-align:right;">
-7.967
</td>
<td style="text-align:right;">
43.362
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:left;">
0.251
</td>
</tr>
<tr>
<td style="text-align:left;">
21 green - 0 green
</td>
<td style="text-align:right;">
83.048
</td>
<td style="text-align:right;">
36.249
</td>
<td style="text-align:right;">
129.846
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:left;">
&lt; .001
</td>
</tr>
<tr>
<td style="text-align:left;">
21 green - 21 blue
</td>
<td style="text-align:right;">
66.996
</td>
<td style="text-align:right;">
15.545
</td>
<td style="text-align:right;">
118.446
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:left;">
0.007
</td>
</tr>
<tr>
<td style="text-align:left;">
0 green - 0 blue
</td>
<td style="text-align:right;">
1.645
</td>
<td style="text-align:right;">
-12.554
</td>
<td style="text-align:right;">
15.844
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:left;">
0.988
</td>
</tr>
</tbody>
</table>
<p>Post-hoc comparisons investigating the differences between treatments based on whether guppies are untrained or trained reveals that initially, when untrained, there was no difference in the strength of preference for the rewarding object between the treatments (blue-trained guppies had a blue object preference of 1.8 seconds and green-trained guppies had a green object preference of 3.5 seconds, p &lt; .001).</p>
<p>Comparing the shift in rewarding object preference between initial and final preference tests in blue-trained and green-trained guppies reveals that the shift in rewarding object preference is significant for green-trained guppies but not for blue-trained guppies. Green trained guppies increased their preference for the green object by 83 seconds (going from a green object preference of 3.5 seconds initially to 86.5 seconds at final test, p &lt; .001) whereas blue-trained guppies non-significantly increased their preference for the blue object by 17.7 seconds (going from a blue object preference 1.8 seconds initially to 19.5 seconds at final test, p = 0.251). For a full description of post-hoc comparisons see table <a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html#tab:contrasts-table">1</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="model-2-preference-for-the-rewarding-object-during-training.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="esm-model-1-preference-for-the-rewarded-object-during-training-based-on-feeding.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Analysis-for-Bias-in-the-shift-of-foraging-preference-for-coloured-objects-in-Trinidadian-guppies.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
