<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Model 3 - Preference for the rewarded object during testing depending on treatment | Analysis for Biases in learned foraging preferences for coloured objects in Trinidadian guppies</title>
  <meta name="description" content="4 Model 3 - Preference for the rewarded object during testing depending on treatment | Analysis for Biases in learned foraging preferences for coloured objects in Trinidadian guppies" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Model 3 - Preference for the rewarded object during testing depending on treatment | Analysis for Biases in learned foraging preferences for coloured objects in Trinidadian guppies" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Model 3 - Preference for the rewarded object during testing depending on treatment | Analysis for Biases in learned foraging preferences for coloured objects in Trinidadian guppies" />
  
  
  

<meta name="author" content="Wyatt Toure" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="model-2-preference-for-the-rewarding-object-during-training.html"/>
<link rel="next" href="model-4-preference-for-the-rewarded-object-during-training-based-on-feeding.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Colour learning analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Background</a></li>
<li class="chapter" data-level="2" data-path="model-1-preference-for-the-green-object-at-baseline.html"><a href="model-1-preference-for-the-green-object-at-baseline.html"><i class="fa fa-check"></i><b>2</b> Model 1 - Preference for the green object at baseline</a></li>
<li class="chapter" data-level="3" data-path="model-2-preference-for-the-rewarding-object-during-training.html"><a href="model-2-preference-for-the-rewarding-object-during-training.html"><i class="fa fa-check"></i><b>3</b> Model 2 - Preference for the rewarding object during training</a></li>
<li class="chapter" data-level="4" data-path="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html"><a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html"><i class="fa fa-check"></i><b>4</b> Model 3 - Preference for the rewarded object during testing depending on treatment</a><ul>
<li class="chapter" data-level="4.1" data-path="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html"><a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html#main-effects"><i class="fa fa-check"></i><b>4.1</b> Main effects</a></li>
<li class="chapter" data-level="4.2" data-path="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html"><a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html#post-hoc-comparisons"><i class="fa fa-check"></i><b>4.2</b> Post-hoc Comparisons</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="model-4-preference-for-the-rewarded-object-during-training-based-on-feeding.html"><a href="model-4-preference-for-the-rewarded-object-during-training-based-on-feeding.html"><i class="fa fa-check"></i><b>5</b> Model 4 - Preference for the rewarded object during training based on feeding</a></li>
<li class="chapter" data-level="6" data-path="model-5-is-there-a-difference-in-feeding-attempts-between-treatments.html"><a href="model-5-is-there-a-difference-in-feeding-attempts-between-treatments.html"><i class="fa fa-check"></i><b>6</b> Model 5 - Is there a difference in feeding attempts between treatments?</a></li>
<li class="chapter" data-level="7" data-path="model-6-controlling-for-feeding-count.html"><a href="model-6-controlling-for-feeding-count.html"><i class="fa fa-check"></i><b>7</b> Model 6 - Controlling for feeding count</a><ul>
<li class="chapter" data-level="7.1" data-path="model-6-controlling-for-feeding-count.html"><a href="model-6-controlling-for-feeding-count.html#model-6a---removing-individual-that-did-not-feed"><i class="fa fa-check"></i><b>7.1</b> Model 6a - Removing individual that did not feed</a></li>
<li class="chapter" data-level="7.2" data-path="model-6-controlling-for-feeding-count.html"><a href="model-6-controlling-for-feeding-count.html#model-6b---including-feeding-counut-as-a-covariate"><i class="fa fa-check"></i><b>7.2</b> Model 6b - Including feeding counut as a covariate</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tools-used-and-references.html"><a href="tools-used-and-references.html"><i class="fa fa-check"></i><b>8</b> Tools used and References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analysis for Biases in learned foraging preferences for coloured objects in Trinidadian guppies</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="model-3---preference-for-the-rewarded-object-during-testing-depending-on-treatment" class="section level1">
<h1><span class="header-section-number">4</span> Model 3 - Preference for the rewarded object during testing depending on treatment</h1>
<div id="main-effects" class="section level2">
<h2><span class="header-section-number">4.1</span> Main effects</h2>
<p>For the main effects of <strong>training</strong> and <strong>rewarding object colour</strong> on rewarding object preference I initially fit a <strong>linear mixed effects model</strong> with <strong>fixed effects of trial</strong> and <strong>rewarding object colour</strong> and a random effect of <strong>individual id</strong>.</p>
<p>Due to heterogeneity in the variance among groups however, I switched to a generalized linear mixed model with a gaussian distribution which also modelled the vaiances to account for variance heterogeneity. My third model asks whether the preference for the rewarding object changed between baseline and final test and looks for an interaction with rewarded object colour.</p>
<p><strong>Variables</strong></p>
<ul>
<li><code>rewarding.object.preference</code> is the time (seconds) spent near the rewarding object subtracted by the time spent near the unrewarding object</li>
<li><code>rewarding.object.colour</code> is the identity of the rewarding object (blue or green)</li>
<li><code>trial</code> is the number of the training trial. In this model it is supplied as a factor where 0 is the baseline trial and 21 is the final trial</li>
<li><code>id</code> is the identity of the individual fish</li>
</ul>
<p><strong>Model</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test.data.model =<span class="st"> </span>
<span class="st">  </span><span class="kw">lmer</span>(rewarding.object.preference <span class="op">~</span><span class="st"> </span>trial <span class="op">*</span><span class="st"> </span>rewarding.object.colour <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>id),
       <span class="dt">data =</span> test.data)

test.data.model2 =<span class="st"> </span><span class="kw">glmmTMB</span>(
  rewarding.object.preference <span class="op">~</span><span class="st">  </span>trial <span class="op">*</span><span class="st"> </span>rewarding.object.colour <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">|</span>id) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span><span class="kw">diag</span>(<span class="dv">0</span> <span class="op">+</span><span class="st"> </span>rewarding.object.colour <span class="op">*</span><span class="st"> </span>trial <span class="op">|</span>id), 
  <span class="dt">data =</span> test.data, <span class="dt">family =</span> gaussian
)</code></pre></div>
<p><strong>Results</strong></p>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="left">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">trial21</td>
<td align="right">17.697370</td>
<td align="right">10.011902</td>
<td align="right">1.7676331</td>
<td align="left">0.077</td>
</tr>
<tr class="even">
<td align="left">rewarding.object.colourgreen</td>
<td align="right">1.645018</td>
<td align="right">5.551534</td>
<td align="right">0.2963177</td>
<td align="left">0.767</td>
</tr>
<tr class="odd">
<td align="left">trial21:rewarding.object.colourgreen</td>
<td align="right">65.350747</td>
<td align="right">19.999728</td>
<td align="right">3.2675818</td>
<td align="left">0.001</td>
</tr>
</tbody>
</table>
<p>I found a significant interaction effect between trial and rewarding object colour (p = 0.001). Guppies that had green rewarded had a final rewarded object preference that was 65.4 seconds stronger than the rewarded object preference of guppies trained to blue (Figure <a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html#fig:test-data-pref-plot">4.1</a>).</p>
<center>
<div class="figure"><span id="fig:test-data-pref-plot"></span>
<img src="Analysis-for-Bias-in-the-shift-of-foraging-preference-for-coloured-objects-in-Trinidadian-guppies_files/figure-html/test-data-pref-plot-1.png" alt="The initial and final rewarding object preference. Dashed line represents the no preference value. Data are means +/- 95% CI. Bold line connects means across trials." width="672" />
<p class="caption">
Figure 4.1: The initial and final rewarding object preference. Dashed line represents the no preference value. Data are means +/- 95% CI. Bold line connects means across trials.
</p>
</div>
</center>
<p></br></p>
<p><strong>Model Residuals</strong></p>
<p>Originally I fit a LMM but they variance among the groups was uneven producing the following residual plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">simulationOutput &lt;-<span class="st"> </span><span class="kw">simulateResiduals</span>(<span class="dt">fittedModel =</span> test.data.model, <span class="dt">n =</span> <span class="dv">1000</span>)
<span class="kw">plot</span>(simulationOutput)</code></pre></div>
<p><img src="Analysis-for-Bias-in-the-shift-of-foraging-preference-for-coloured-objects-in-Trinidadian-guppies_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>I therefore used glmmTMB to allow for the modelling of the variances and accounut for heterogeneous variance.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">simulationOutput &lt;-<span class="st"> </span><span class="kw">simulateResiduals</span>(<span class="dt">fittedModel =</span> test.data.model2, <span class="dt">n =</span> <span class="dv">1000</span>)
<span class="kw">plot</span>(simulationOutput)</code></pre></div>
<p><img src="Analysis-for-Bias-in-the-shift-of-foraging-preference-for-coloured-objects-in-Trinidadian-guppies_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p></br></p>
</div>
<div id="post-hoc-comparisons" class="section level2">
<h2><span class="header-section-number">4.2</span> Post-hoc Comparisons</h2>
<p>To determine whether the means of the final rewarding object preference for thw two treatments were different I conducted post-hoc comparisons with the package <a href="https://cran.r-project.org/package=emmeans"><code>emmeans</code></a>. I comapred the following means:</p>
<ul>
<li>Final test blue-trained and initial test blue-trained</li>
<li>Final test green-trained and initial test green-trained</li>
<li>Final test green-trained and final test blue-trained</li>
<li>Initial test green-trained and initial test blue-trained</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test.data.model.pairwise.comparisons =<span class="st"> </span>
<span class="st">  </span><span class="kw">emmeans</span>(test.data.model2, <span class="dt">specs =</span> <span class="op">~</span><span class="st"> </span>trial<span class="op">:</span>rewarding.object.colour)

custom.contrasts =<span class="st"> </span><span class="kw">contrast</span>(test.data.model.pairwise.comparisons, 
                            <span class="dt">method =</span> <span class="kw">list</span>(<span class="st">&quot;21 blue - 0 blue&quot;</span> =<span class="st"> </span>blue21<span class="op">-</span><span class="st"> </span>blue0,
                                          <span class="st">&quot;21 green - 0 green &quot;</span> =<span class="st"> </span>green21 <span class="op">-</span><span class="st"> </span>green0,
                                          <span class="st">&quot;21 green - 21 blue&quot;</span> =<span class="st"> </span>green21 <span class="op">-</span><span class="st"> </span>blue21,
                                          <span class="st">&quot;0 green - 0 blue&quot;</span> =<span class="st"> </span>green0<span class="op">-</span><span class="st"> </span>blue0), 
                            <span class="dt">adjust =</span> <span class="st">&quot;mvt&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summary</span>(<span class="dt">infer =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Post-hoc comparisons investigating the differences between treatments based on whether guppies are untrained or trained reveals that initially there was no difference in the strength of preference for the rewarding object between the treatments (blue-trained guppies had a blue object preference of 1.8 seconds and green-trained guppies had a green object preference of 3.5 seconds, p &lt; .001).</p>
<p>Comparing the shift in rewarding object preference between initial and final preference tests in blue-trained and green-trained guppies reveals that the shift in rewarding object preference is significant for green-trained guppies but not for blue-trained guppies. Green trained guppies increased their preference for the green object by 83 seconds (going from a green object preference of 3.5 seconds initially to 86.5 seconds at final test, p &lt; .001) whereas blue-trained guppies non-significantly increased their preference for the blue object by 17.7 seconds (going from a blue object preference 1.8 seconds initially to 19.5 seconds at final test, p = 0.252). For a full description of post-hoc comparisons see table <a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html#tab:contrasts-table">4.1</a>.</p>
<p><br /></p>
<table>
<caption><span id="tab:contrasts-table">Table 4.1: </span>Table of post-hoc tests with a multivariate-t adjustment for multiple comparisons of a selected set of means. The numbers represent the initial test trial (0) and the final test trial (21). The colour corressponds to the identity of the rewarding object (blue for blue-trained guppies, green for green-trained guppies). Values are all rounded to 3 decimal places. CL = confidence limit</caption>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="right">estimate</th>
<th align="right">lower.CL</th>
<th align="right">upper.CL</th>
<th align="right">df</th>
<th align="left">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">21 blue - 0 blue</td>
<td align="right">17.697</td>
<td align="right">-7.960</td>
<td align="right">43.355</td>
<td align="right">34</td>
<td align="left">0.252</td>
</tr>
<tr class="even">
<td align="left">21 green - 0 green</td>
<td align="right">83.048</td>
<td align="right">38.679</td>
<td align="right">127.417</td>
<td align="right">34</td>
<td align="left">&lt; .001</td>
</tr>
<tr class="odd">
<td align="left">21 green - 21 blue</td>
<td align="right">66.996</td>
<td align="right">15.874</td>
<td align="right">118.118</td>
<td align="right">34</td>
<td align="left">0.007</td>
</tr>
<tr class="even">
<td align="left">0 green - 0 blue</td>
<td align="right">1.645</td>
<td align="right">-12.582</td>
<td align="right">15.872</td>
<td align="right">34</td>
<td align="left">0.988</td>
</tr>
</tbody>
</table>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="model-2-preference-for-the-rewarding-object-during-training.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="model-4-preference-for-the-rewarded-object-during-training-based-on-feeding.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Analysis-for-Bias-in-the-shift-of-foraging-preference-for-coloured-objects-in-Trinidadian-guppies.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
