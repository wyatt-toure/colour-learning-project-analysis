<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Model 3 - Preference for the rewarded object during testing depending on treatment | Analysis for Biases in learned foraging preferences for coloured objects in Trinidadian guppies</title>
  <meta name="description" content="4 Model 3 - Preference for the rewarded object during testing depending on treatment | Analysis for Biases in learned foraging preferences for coloured objects in Trinidadian guppies" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Model 3 - Preference for the rewarded object during testing depending on treatment | Analysis for Biases in learned foraging preferences for coloured objects in Trinidadian guppies" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Model 3 - Preference for the rewarded object during testing depending on treatment | Analysis for Biases in learned foraging preferences for coloured objects in Trinidadian guppies" />
  
  
  

<meta name="author" content="Wyatt Toure" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="model-2-preference-for-the-rewarding-object-during-training.html"/>
<link rel="next" href="model-4-preference-for-the-rewarded-object-during-training-based-on-feeding.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Colour learning analysis</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Background</a></li>
<li class="chapter" data-level="2" data-path="model-1-preference-for-the-green-object-at-baseline.html"><a href="model-1-preference-for-the-green-object-at-baseline.html"><i class="fa fa-check"></i><b>2</b> Model 1 - Preference for the green object at baseline</a></li>
<li class="chapter" data-level="3" data-path="model-2-preference-for-the-rewarding-object-during-training.html"><a href="model-2-preference-for-the-rewarding-object-during-training.html"><i class="fa fa-check"></i><b>3</b> Model 2 - Preference for the rewarding object during training</a></li>
<li class="chapter" data-level="4" data-path="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html"><a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html"><i class="fa fa-check"></i><b>4</b> Model 3 - Preference for the rewarded object during testing depending on treatment</a></li>
<li class="chapter" data-level="5" data-path="model-4-preference-for-the-rewarded-object-during-training-based-on-feeding.html"><a href="model-4-preference-for-the-rewarded-object-during-training-based-on-feeding.html"><i class="fa fa-check"></i><b>5</b> Model 4 - Preference for the rewarded object during training based on feeding</a></li>
<li class="chapter" data-level="6" data-path="model-5-is-there-a-difference-in-feeding-attempts-between-treatments.html"><a href="model-5-is-there-a-difference-in-feeding-attempts-between-treatments.html"><i class="fa fa-check"></i><b>6</b> Model 5 - Is there a difference in feeding attempts between treatments?</a></li>
<li class="chapter" data-level="7" data-path="model-6-controlling-for-feeding-count.html"><a href="model-6-controlling-for-feeding-count.html"><i class="fa fa-check"></i><b>7</b> Model 6 - Controlling for feeding count</a></li>
<li class="chapter" data-level="8" data-path="tools-used-and-references.html"><a href="tools-used-and-references.html"><i class="fa fa-check"></i><b>8</b> Tools used and References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analysis for Biases in learned foraging preferences for coloured objects in Trinidadian guppies</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="model-3---preference-for-the-rewarded-object-during-testing-depending-on-treatment" class="section level1">
<h1><span class="header-section-number">4</span> Model 3 - Preference for the rewarded object during testing depending on treatment</h1>
<p>For the main effects of <strong>training</strong> and <strong>rewarding object colour</strong> on object preference I fit a <strong>linear mixed effects model</strong> with <strong>fixed effects of trial</strong> and <strong>rewarding object colour</strong> and a random effect of <strong>individual id</strong>. My third model asks whether the preference for the rewarding object changed between baseline and final test and looks for an interaction with rewarded object colour. In this model trial is a categorical variable composed of the intial preference trial (trial 0) and the final preference trial (trial 21).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test.data.model =<span class="st"> </span>
<span class="st">  </span><span class="kw">lmer</span>(rewarding.object.preference <span class="op">~</span><span class="st"> </span>rewarding.object.colour <span class="op">*</span><span class="st"> </span>trial <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">|</span><span class="st"> </span>id),
       <span class="dt">data =</span> test.data)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">df</th>
<th align="left">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">rewarding.object.colourgreen</td>
<td align="right">1.644943</td>
<td align="right">16.31541</td>
<td align="right">0.1008214</td>
<td align="right">39.90828</td>
<td align="left">0.92</td>
</tr>
<tr class="even">
<td align="left">trial21</td>
<td align="right">17.697361</td>
<td align="right">16.62739</td>
<td align="right">1.0643497</td>
<td align="right">19.99995</td>
<td align="left">0.3</td>
</tr>
<tr class="odd">
<td align="left">rewarding.object.colourgreen:trial21</td>
<td align="right">65.350597</td>
<td align="right">22.51360</td>
<td align="right">2.9027170</td>
<td align="right">19.99995</td>
<td align="left">0.009</td>
</tr>
</tbody>
</table>
<p>I found a significant interaction effect between trial and rewarding object colour (p = 0.009). Guppies that had green rewarded had a final rewarded object preference that was 65.4 seconds stronger than the rewarded object preference of guppies trained to blue (Figure <a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html#fig:test-data-pref-plot">4.1</a>).</p>
<center>
<div class="figure"><span id="fig:test-data-pref-plot"></span>
<img src="Analysis-for-Bias-in-the-shift-of-foraging-preference-for-coloured-objects-in-Trinidadian-guppies_files/figure-html/test-data-pref-plot-1.png" alt="The initial and final rewarding object preference. Dashed line represents the no preference value. Data are means +/- 95% CI. Bold line connects means across trials." width="672" />
<p class="caption">
Figure 4.1: The initial and final rewarding object preference. Dashed line represents the no preference value. Data are means +/- 95% CI. Bold line connects means across trials.
</p>
</div>
</center>
<p></br></p>
<p><strong>Model Diagnostics</strong></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">simulationOutput &lt;-<span class="st"> </span><span class="kw">simulateResiduals</span>(<span class="dt">fittedModel =</span> test.data.model)
<span class="kw">plot</span>(simulationOutput)</code></pre></div>
<p><img src="Analysis-for-Bias-in-the-shift-of-foraging-preference-for-coloured-objects-in-Trinidadian-guppies_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p></br></p>
<p><strong>Post-Hoc Comparisons</strong></p>
<p>To determine whether the means of the final rewarding object preference for thw two treatments were different I conducted post-hoc comparisons with the package emmeans.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">test.data.model.pairwise.comparisons =<span class="st"> </span>
<span class="st">  </span><span class="kw">emmeans</span>(test.data.model, 
          <span class="dt">specs =</span> pairwise <span class="op">~</span><span class="st"> </span>trial<span class="op">:</span>rewarding.object.colour) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">summary</span>(<span class="dt">infer =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>Post-hoc comparisons investigating the differences between treatments based on whether guppies are untrained or trained reveals that initially there was no difference in the strength of preference for the rewarding object between the treatments (blue-trained guppies had a blue object preference of 1.8 seconds and green-trained guppies had a green object preference of 3.5 seconds, p = 1).</p>
<p>Comparing the shift in rewarding object preference between initial and final preference tests in blue-trained and green-trained guppies reveals that the shift in rewarding object preference is significant for green-trained guppies but not for blue-trained guppies. Green trained guppies increased their preference for the green object by 83 seconds (going from a green object preference of 3.5 seconds initially to 86.5 seconds at final test, p &lt; .001) whereas blue-trained guppies non-significantly increased their preference for the blue object by 17.7 seconds (going from a blue object preference 1.8 seconds initially to 19.5 seconds at final test, p = 0.714). For a full description of post-hoc comparisons see table <a href="model-3-preference-for-the-rewarded-object-during-testing-depending-on-treatment.html#tab:contrasts-table">4.1</a>.</p>
<table>
<caption><span id="tab:contrasts-table">Table 4.1: </span>Table of post-hoc tests with Tukey adjustment for multiple comparisons. The numbers represent the initial test trial (0) and the final test trial (21). The colour corressponds to the identity of the rewarding object (blue for blue-trained guppies, green for green-trained guppies). Values are all rounded to 3 decimal places.</caption>
<thead>
<tr class="header">
<th align="left">contrast</th>
<th align="right">estimate</th>
<th align="right">df</th>
<th align="right">lower.CL</th>
<th align="right">upper.CL</th>
<th align="left">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0 blue - 21 blue</td>
<td align="right">-17.697</td>
<td align="right">20.000</td>
<td align="right">-64.236</td>
<td align="right">28.842</td>
<td align="left">0.714</td>
</tr>
<tr class="even">
<td align="left">0 blue - 0 green</td>
<td align="right">-1.645</td>
<td align="right">39.908</td>
<td align="right">-45.381</td>
<td align="right">42.092</td>
<td align="left">1</td>
</tr>
<tr class="odd">
<td align="left">0 blue - 21 green</td>
<td align="right">-84.693</td>
<td align="right">39.908</td>
<td align="right">-128.429</td>
<td align="right">-40.956</td>
<td align="left">&lt; .001</td>
</tr>
<tr class="even">
<td align="left">21 blue - 0 green</td>
<td align="right">16.052</td>
<td align="right">39.908</td>
<td align="right">-27.684</td>
<td align="right">59.789</td>
<td align="left">0.759</td>
</tr>
<tr class="odd">
<td align="left">21 blue - 21 green</td>
<td align="right">-66.996</td>
<td align="right">39.908</td>
<td align="right">-110.732</td>
<td align="right">-23.259</td>
<td align="left">0.001</td>
</tr>
<tr class="even">
<td align="left">0 green - 21 green</td>
<td align="right">-83.048</td>
<td align="right">20.000</td>
<td align="right">-125.532</td>
<td align="right">-40.564</td>
<td align="left">&lt; .001</td>
</tr>
</tbody>
</table>
<p><br /></p>
<p><strong>Testing blue-trained guppies separately</strong></p>
<p>It does look like blue trained guppies are shifting their preference slightly but the effect might be getting drowned out by the large shift in preference of green-trained guppies so I looked at blue-trained guppies alone in a separate model.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">blue.guppies.test.data =<span class="st"> </span>test.data <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(rewarding.object.colour <span class="op">==</span><span class="st"> &#39;blue&#39;</span>)

blue.guppies.test.data.model =<span class="st"> </span>
<span class="st">  </span><span class="kw">lm</span>(rewarding.object.preference <span class="op">~</span><span class="st"> </span>trial,
       <span class="dt">data =</span> blue.guppies.test.data)</code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="left">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">1.841809</td>
<td align="right">7.466217</td>
<td align="right">0.2466857</td>
<td align="left">0.808</td>
</tr>
<tr class="even">
<td align="left">trial21</td>
<td align="right">17.697361</td>
<td align="right">10.558825</td>
<td align="right">1.6760729</td>
<td align="left">0.111</td>
</tr>
</tbody>
</table>
<p>We see that the shift in preference between baseline trial and the final trial is still not significant (p = 0.111) in blue trained guppies though there seems to be a definite trend and the effect is in the expected direction. The random effect of ID was dropped here since it led to a singular fit, there was much more residual variance compared to individual variance, ID random effect did not significantly improve model fit.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="model-2-preference-for-the-rewarding-object-during-training.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="model-4-preference-for-the-rewarded-object-during-training-based-on-feeding.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Analysis-for-Bias-in-the-shift-of-foraging-preference-for-coloured-objects-in-Trinidadian-guppies.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
